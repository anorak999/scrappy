<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Scrappy</title>
  <link rel="stylesheet" href="popup.css">
</head>
<body>
  <div class="container">
    <!-- Header -->
    <header class="header">
      <div class="logo">
        <svg class="logo-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
          <path d="M12 2L2 7l10 5 10-5-10-5z"/>
          <path d="M2 17l10 5 10-5"/>
          <path d="M2 12l10 5 10-5"/>
        </svg>
        <span class="logo-text">Scrappy</span>
      </div>
      <div class="header-actions">
        <button id="history-btn" class="icon-btn" title="History" aria-label="Capture History">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <circle cx="12" cy="12" r="10"/>
            <polyline points="12 6 12 12 16 14"/>
          </svg>
        </button>
        <button id="settings-btn" class="icon-btn" title="Settings" aria-label="Settings">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <circle cx="12" cy="12" r="3"/>
            <path d="M12 1v4M12 19v4M4.22 4.22l2.83 2.83M16.95 16.95l2.83 2.83M1 12h4M19 12h4M4.22 19.78l2.83-2.83M16.95 7.05l2.83-2.83"/>
          </svg>
        </button>
      </div>
    </header>

    <!-- Main Content -->
    <main class="main">
      <!-- Page Info with Resource Stats -->
      <section class="page-info" id="page-info">
        <div class="page-meta">
          <div class="page-title" id="page-title">
            <span class="skeleton"></span>
          </div>
          <div class="page-url" id="page-url">
            <span class="skeleton skeleton-sm"></span>
          </div>
        </div>
        <div class="resource-stats hidden" id="resource-stats">
          <div class="stat" title="Images">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
              <rect x="3" y="3" width="18" height="18" rx="2"/>
              <circle cx="8.5" cy="8.5" r="1.5"/>
              <polyline points="21 15 16 10 5 21"/>
            </svg>
            <span id="stat-images">0</span>
          </div>
          <div class="stat" title="Stylesheets">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
              <path d="M4 4h16v16H4z"/>
              <path d="M9 9h6M9 12h4M9 15h5"/>
            </svg>
            <span id="stat-styles">0</span>
          </div>
          <div class="stat" title="Scripts">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
              <polyline points="16 18 22 12 16 6"/>
              <polyline points="8 6 2 12 8 18"/>
            </svg>
            <span id="stat-scripts">0</span>
          </div>
          <div class="stat" title="Fonts">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
              <path d="M4 7V4h16v3"/>
              <path d="M9 20h6"/>
              <path d="M12 4v16"/>
            </svg>
            <span id="stat-fonts">0</span>
          </div>
        </div>
      </section>

      <!-- Page Metadata (og:description etc) -->
      <section class="page-metadata hidden" id="page-metadata">
        <div class="metadata-item" id="meta-description"></div>
        <div class="metadata-tags" id="meta-tags"></div>
      </section>

      <!-- Format Selector -->
      <section class="format-section">
        <div class="section-header">
          <label class="section-label">Format</label>
          <span class="size-estimate" id="size-estimate"></span>
        </div>
        <div class="format-options" id="format-options">
          <button class="format-btn active" data-format="html" title="Self-contained HTML with embedded resources">
            <svg class="format-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
              <path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/>
              <polyline points="14 2 14 8 20 8"/>
              <line x1="16" y1="13" x2="8" y2="13"/>
              <line x1="16" y1="17" x2="8" y2="17"/>
            </svg>
            <span class="format-name">HTML</span>
          </button>
          <button class="format-btn" data-format="mhtml" title="Web Archive - native browser format">
            <svg class="format-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
              <path d="M21 8v13H3V8"/>
              <path d="M1 3h22v5H1z"/>
              <path d="M10 12h4"/>
            </svg>
            <span class="format-name">MHTML</span>
          </button>
          <button class="format-btn" data-format="zip" title="ZIP Archive with separate assets">
            <svg class="format-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
              <path d="M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5a2 2 0 012-2h5l2 3h9a2 2 0 012 2z"/>
              <line x1="12" y1="11" x2="12" y2="17"/>
              <line x1="9" y1="14" x2="15" y2="14"/>
            </svg>
            <span class="format-name">ZIP</span>
          </button>
          <button class="format-btn" data-format="pdf" title="PDF Document - print-ready">
            <svg class="format-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
              <path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/>
              <polyline points="14 2 14 8 20 8"/>
              <path d="M9 13h2a1 1 0 110 2H9v3"/>
              <path d="M15 13v5"/>
            </svg>
            <span class="format-name">PDF</span>
          </button>
        </div>
      </section>

      <!-- Capture Options (Quick Toggles) -->
      <section class="quick-options" id="quick-options">
        <button class="option-chip active" data-option="lazyload" title="Scroll page to load all lazy content">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <path d="M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M2 12h4M18 12h4M4.93 19.07l2.83-2.83M16.24 7.76l2.83-2.83"/>
          </svg>
          <span>Lazy Load</span>
        </button>
        <button class="option-chip active" data-option="cleanups" title="Remove ads, popups, overlays">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <path d="M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6"/>
            <path d="M8 6V4a2 2 0 012-2h4a2 2 0 012 2v2"/>
          </svg>
          <span>Clean</span>
        </button>
        <button class="option-chip" data-option="minify" title="Minify HTML/CSS output">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <polyline points="4 14 10 14 10 20"/>
            <polyline points="20 10 14 10 14 4"/>
            <line x1="14" y1="10" x2="21" y2="3"/>
            <line x1="3" y1="21" x2="10" y2="14"/>
          </svg>
          <span>Minify</span>
        </button>
      </section>

      <!-- Capture Button -->
      <section class="action-section">
        <button id="scrape-btn" class="scrape-btn">
          <svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/>
            <polyline points="7 10 12 15 17 10"/>
            <line x1="12" y1="15" x2="12" y2="3"/>
          </svg>
          <span class="btn-text">Capture</span>
        </button>
      </section>

      <!-- Progress -->
      <section class="progress-section hidden" id="progress-section">
        <div class="loader">
          <div class="loader-ring"></div>
          <div class="loader-ring"></div>
          <div class="loader-ring"></div>
        </div>
        <div class="progress-bar">
          <div class="progress-fill" id="progress-fill"></div>
        </div>
        <div class="progress-text" id="progress-text">Initializing</div>
        <div class="progress-stats hidden" id="progress-stats">
          <span id="progress-resources">0/0 resources</span>
        </div>
      </section>

      <!-- Result -->
      <section class="result-section hidden" id="result-section">
        <div class="result-icon" id="result-icon">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path class="checkmark" d="M20 6L9 17l-5-5"/>
          </svg>
        </div>
        <div class="result-message" id="result-message">Complete</div>
        <div class="result-details" id="result-details"></div>
        <div class="result-actions">
          <button class="result-btn" id="open-file-btn" title="Show in folder">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
              <path d="M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5a2 2 0 012-2h5l2 3h9a2 2 0 012 2z"/>
            </svg>
          </button>
          <button class="result-btn" id="copy-path-btn" title="Copy file path">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
              <rect x="9" y="9" width="13" height="13" rx="2"/>
              <path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/>
            </svg>
          </button>
        </div>
      </section>

      <!-- Error -->
      <section class="error-section hidden" id="error-section">
        <div class="error-icon">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"/>
            <line x1="15" y1="9" x2="9" y2="15"/>
            <line x1="9" y1="9" x2="15" y2="15"/>
          </svg>
        </div>
        <div class="error-message" id="error-message"></div>
        <button class="retry-btn" id="retry-btn">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="23 4 23 10 17 10"/>
            <path d="M20.49 15a9 9 0 11-2.12-9.36L23 10"/>
          </svg>
          Retry
        </button>
      </section>
    </main>

    <!-- History Panel -->
    <aside class="panel hidden" id="history-panel">
      <div class="panel-header">
        <h2>History</h2>
        <button id="history-close" class="icon-btn" aria-label="Close">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"/>
            <line x1="6" y1="6" x2="18" y2="18"/>
          </svg>
        </button>
      </div>
      <div class="panel-content">
        <div class="history-list" id="history-list">
          <div class="empty-state">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
              <circle cx="12" cy="12" r="10"/>
              <polyline points="12 6 12 12 16 14"/>
            </svg>
            <p>No captures yet</p>
          </div>
        </div>
        <button class="btn-secondary btn-full" id="clear-history">Clear All</button>
      </div>
    </aside>

    <!-- Settings Panel -->
    <aside class="panel hidden" id="settings-panel">
      <div class="panel-header">
        <h2>Settings</h2>
        <button id="settings-close" class="icon-btn" aria-label="Close">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"/>
            <line x1="6" y1="6" x2="18" y2="18"/>
          </svg>
        </button>
      </div>
      
      <div class="panel-content">
        <div class="setting-group">
          <label class="setting-label">
            <input type="checkbox" id="setting-inline-resources" checked>
            <span class="checkbox-custom"></span>
            <span>Inline Resources</span>
          </label>
          <p class="setting-description">Embed CSS, JS, images as data URIs</p>
        </div>

        <div class="setting-group">
          <label class="setting-label">
            <input type="checkbox" id="setting-include-scripts" checked>
            <span class="checkbox-custom"></span>
            <span>Include Scripts</span>
          </label>
          <p class="setting-description">Preserve JavaScript execution</p>
        </div>

        <div class="setting-group">
          <label class="setting-label">
            <input type="checkbox" id="setting-include-styles" checked>
            <span class="checkbox-custom"></span>
            <span>Include Styles</span>
          </label>
          <p class="setting-description">Preserve CSS styling</p>
        </div>

        <div class="setting-group">
          <label class="setting-label">
            <input type="checkbox" id="setting-remove-tracking">
            <span class="checkbox-custom"></span>
            <span>Remove Tracking</span>
          </label>
          <p class="setting-description">Strip analytics, trackers, beacons</p>
        </div>

        <div class="setting-group">
          <label class="setting-label">
            <input type="checkbox" id="setting-preserve-forms">
            <span class="checkbox-custom"></span>
            <span>Preserve Form Data</span>
          </label>
          <p class="setting-description">Save input field values</p>
        </div>

        <div class="setting-group">
          <label class="setting-label" for="setting-timeout">Resource Timeout (s)</label>
          <input type="number" id="setting-timeout" min="5" max="60" value="10" class="setting-input">
        </div>

        <div class="setting-group">
          <label class="setting-label" for="setting-max-size">Max Resource Size (MB)</label>
          <input type="number" id="setting-max-size" min="1" max="50" value="5" class="setting-input">
        </div>

        <div class="setting-actions">
          <button id="settings-reset" class="btn-secondary">Reset</button>
          <button id="settings-save" class="btn-primary">Save</button>
        </div>
      </div>
    </aside>

    <!-- Footer -->
    <footer class="footer">
      <p class="disclaimer">Respect terms of service</p>
    </footer>
  </div>

  <script src="popup.js" type="module"></script>
</body>
</html>
